<!doctype html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd"><title></title><meta content="text/html; charset=utf-8"http-equiv=content-type><style>pre{line-height:125%}td.linenos .normal,span.linenos{color:inherit;background-color:#0000;padding-left:5px;padding-right:5px}td.linenos .special,span.linenos.special{color:#000;background-color:#ffffc0;padding-left:5px;padding-right:5px}body .hll{background-color:#ffc}body{background:#f8f8f8}body .c{color:#3d7b7b;font-style:italic}body .err{border:1px solid red}body .k{color:green;font-weight:700}body .o{color:#666}body .ch,body .cm{color:#3d7b7b;font-style:italic}body .cp{color:#9c6500}body .cpf,body .c1,body .cs{color:#3d7b7b;font-style:italic}body .gd{color:#a00000}body .ge{font-style:italic}body .ges{font-style:italic;font-weight:700}body .gr{color:#e40000}body .gh{color:navy;font-weight:700}body .gi{color:#008400}body .go{color:#717171}body .gp{color:navy;font-weight:700}body .gs{font-weight:700}body .gu{color:purple;font-weight:700}body .gt{color:#04d}body .kc,body .kd,body .kn{color:green;font-weight:700}body .kp{color:green}body .kr{color:green;font-weight:700}body .kt{color:#b00040}body .m{color:#666}body .s{color:#ba2121}body .na{color:#687822}body .nb{color:green}body .nc{color:#00f;font-weight:700}body .no{color:#800}body .nd{color:#a2f}body .ni{color:#717171;font-weight:700}body .ne{color:#cb3f38;font-weight:700}body .nf{color:#00f}body .nl{color:#767600}body .nn{color:#00f;font-weight:700}body .nt{color:green;font-weight:700}body .nv{color:#19177c}body .ow{color:#a2f;font-weight:700}body .w{color:#bbb}body .mb,body .mf,body .mh,body .mi,body .mo{color:#666}body .sa,body .sb,body .sc,body .dl{color:#ba2121}body .sd{color:#ba2121;font-style:italic}body .s2{color:#ba2121}body .se{color:#aa5d1f;font-weight:700}body .sh{color:#ba2121}body .si{color:#a45a77;font-weight:700}body .sx{color:green}body .sr{color:#a45a77}body .s1{color:#ba2121}body .ss{color:#19177c}body .bp{color:green}body .fm{color:#00f}body .vc,body .vg,body .vi,body .vm{color:#19177c}body .il{color:#666}</style><body><h2></h2><div class=highlight><pre><span></span><span class=sd>"""</span>
<span class=sd>We execute an experiment with 2 algorithms on 2 problems and plot the progress.</span>

<span class=sd>Progress diagrams illustrate how algorithms, well, progress over time.</span>
<span class=sd>They can be created from log files if these include the improvements, i.e,</span>
<span class=sd>were created with `ex.set_log_improvements(True)`.</span>

<span class=sd>There are four tools involved in creating such diagrams:</span>

<span class=sd>The module `moptipy.utils.plot_utils` provides the functions for allocating</span>
<span class=sd>and storing figures (named `create_figure` and `save_figure`).</span>

<span class=sd>The module `moptipy.evaluation.progress` includes the class `Progress`.</span>
<span class=sd>An instance `Progress` represents a two-dimensional progress curve of a</span>
<span class=sd>single run.</span>
<span class=sd>Its time dimensions can either be `FEs` or `ms`. In the former case, it</span>
<span class=sd>records the time in objective function evaluations (FEs) and in the latter</span>
<span class=sd>case, it records them in milliseconds.</span>
<span class=sd>Its objective dimension can either be `plainF`, `scaledF` or `normalizedF`.</span>
<span class=sd>In the first case, all objective values `f` are represented as recorded in the</span>
<span class=sd>log file. In the second case, they are divided by the goal objective value</span>
<span class=sd>`goal_f` (as recorded in the log file) and in the last case, they are</span>
<span class=sd>normalized as `(f - goal_f) / goal_f`. The former two cases will fail if the</span>
<span class=sd>log file does not contain goal objective values. But if they do, this allows</span>
<span class=sd>you to show progress plots of different problems in the same plot in a</span>
<span class=sd>reasonable way.</span>

<span class=sd>The module `moptipy.evaluation.stat_run` provides the class `StatRun`. This</span>
<span class=sd>class allows you to convert a set of `Progress` objects into a statistics</span>
<span class=sd>curve. For example, maybe you have collected 10 runs of an optimization</span>
<span class=sd>algorithm for a given problem. You do not want to plot all 10 runs, but</span>
<span class=sd>instead, you want to plot the arithmetic mean of their objective values. You</span>
<span class=sd>can then construct a statistics run for these objects and plot that one</span>
<span class=sd>instead.</span>

<span class=sd>Finally, the module `moptipy.evaluation.plot_progress_impl` provides the</span>
<span class=sd>function `plot_progress`. This function accepts a sequence contain `Progress`</span>
<span class=sd>and/or `StatRun` objects and illustrates them automatically. It will</span>
<span class=sd>automatically choose axis labels, colors, and group and order the data in</span>
<span class=sd>a way that it deems reasonable.</span>

<span class=sd>In this file, we will use all the above tools.</span>
<span class=sd>We will run a small experiment, parse the resulting log files, and then</span>
<span class=sd>illustrate different groupings and selections of the data.</span>
<span class=sd>We will create svg figures and open them in the web browser for viewing.</span>
<span class=sd>"""</span>
<span class=kn>from</span><span class=w> </span><span class=nn>time</span><span class=w> </span><span class=kn>import</span> <span class=n>sleep</span>
<span class=kn>from</span><span class=w> </span><span class=nn>webbrowser</span><span class=w> </span><span class=kn>import</span> <span class=n>open_new_tab</span>

<span class=kn>from</span><span class=w> </span><span class=nn>pycommons.io.temp</span><span class=w> </span><span class=kn>import</span> <span class=n>temp_dir</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pycommons.processes.caller</span><span class=w> </span><span class=kn>import</span> <span class=n>is_build</span>

<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.algorithms.random_walk</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomWalk</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.algorithms.so.rls</span><span class=w> </span><span class=kn>import</span> <span class=n>RLS</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.api.execution</span><span class=w> </span><span class=kn>import</span> <span class=n>Execution</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.api.experiment</span><span class=w> </span><span class=kn>import</span> <span class=n>run_experiment</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.evaluation.axis_ranger</span><span class=w> </span><span class=kn>import</span> <span class=n>AxisRanger</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.evaluation.plot_progress</span><span class=w> </span><span class=kn>import</span> <span class=n>plot_progress</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.evaluation.progress</span><span class=w> </span><span class=kn>import</span> <span class=n>from_logs</span> <span class=k>as</span> <span class=n>pr_from_logs</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.evaluation.stat_run</span><span class=w> </span><span class=kn>import</span> <span class=n>StatRun</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.evaluation.stat_run</span><span class=w> </span><span class=kn>import</span> <span class=n>from_progress</span> <span class=k>as</span> <span class=n>sr_from_progress</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.examples.bitstrings.ising1d</span><span class=w> </span><span class=kn>import</span> <span class=n>Ising1d</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.examples.bitstrings.onemax</span><span class=w> </span><span class=kn>import</span> <span class=n>OneMax</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.operators.bitstrings.op0_random</span><span class=w> </span><span class=kn>import</span> <span class=n>Op0Random</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.operators.bitstrings.op1_flip1</span><span class=w> </span><span class=kn>import</span> <span class=n>Op1Flip1</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.spaces.bitstrings</span><span class=w> </span><span class=kn>import</span> <span class=n>BitStrings</span>
<span class=kn>from</span><span class=w> </span><span class=nn>moptipy.utils.plot_utils</span><span class=w> </span><span class=kn>import</span> <span class=n>create_figure</span><span class=p>,</span> <span class=n>save_figure</span>

<span class=c1># The two problems we want to try to solve:</span>
<span class=n>problems</span> <span class=o>=</span> <span class=p>[</span><span class=k>lambda</span><span class=p>:</span> <span class=n>OneMax</span><span class=p>(</span><span class=mi>32</span><span class=p>),</span>  <span class=c1># 32-dimensional OneMax</span>
            <span class=k>lambda</span><span class=p>:</span> <span class=n>Ising1d</span><span class=p>(</span><span class=mi>32</span><span class=p>)]</span>  <span class=c1># 32-dimensional one-dimensional Ising Model</span>


<span class=k>def</span><span class=w> </span><span class=nf>make_rls</span><span class=p>(</span><span class=n>problem</span><span class=p>)</span> <span class=o>-></span> <span class=n>Execution</span><span class=p>:</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Create an RLS Execution.</span>

<span class=sd>    :param problem: the problem (OneMax or Ising1d)</span>
<span class=sd>    :returns: the execution</span>
<span class=sd>    """</span>
    <span class=n>ex</span> <span class=o>=</span> <span class=n>Execution</span><span class=p>()</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_solution_space</span><span class=p>(</span><span class=n>BitStrings</span><span class=p>(</span><span class=n>problem</span><span class=o>.</span><span class=n>n</span><span class=p>))</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_objective</span><span class=p>(</span><span class=n>problem</span><span class=p>)</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_algorithm</span><span class=p>(</span><span class=n>RLS</span><span class=p>(</span>  <span class=c1># create RLS that</span>
        <span class=n>Op0Random</span><span class=p>(),</span>  <span class=c1># starts with a random bit string and</span>
        <span class=n>Op1Flip1</span><span class=p>()))</span>  <span class=c1># flip exactly one bit</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_max_fes</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>  <span class=c1># permit 200 FEs</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_log_improvements</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># log the progress!</span>
    <span class=k>return</span> <span class=n>ex</span>


<span class=k>def</span><span class=w> </span><span class=nf>make_random_walk</span><span class=p>(</span><span class=n>problem</span><span class=p>)</span> <span class=o>-></span> <span class=n>Execution</span><span class=p>:</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Create a Random Walk Execution.</span>

<span class=sd>    :param problem: the problem (OneMax or Ising1d)</span>
<span class=sd>    :returns: the execution</span>
<span class=sd>    """</span>
    <span class=n>ex</span> <span class=o>=</span> <span class=n>Execution</span><span class=p>()</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_solution_space</span><span class=p>(</span><span class=n>BitStrings</span><span class=p>(</span><span class=n>problem</span><span class=o>.</span><span class=n>n</span><span class=p>))</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_objective</span><span class=p>(</span><span class=n>problem</span><span class=p>)</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_algorithm</span><span class=p>(</span>
        <span class=n>RandomWalk</span><span class=p>(</span>  <span class=c1># create a random walk that</span>
            <span class=n>Op0Random</span><span class=p>(),</span>  <span class=c1># starts with a random bit string and</span>
            <span class=n>Op1Flip1</span><span class=p>()))</span>  <span class=c1># flip exactly one bit</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_max_fes</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>  <span class=c1># permit 200 FEs</span>
    <span class=n>ex</span><span class=o>.</span><span class=n>set_log_improvements</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># log the progress!</span>
    <span class=k>return</span> <span class=n>ex</span>


<span class=c1># We execute the whole experiment in a temp directory.</span>
<span class=c1># For a real experiment, you would put an existing directory path into `td` by</span>
<span class=c1># doing `from pycommons.io.path import Path; td = Path("mydir")` and not use</span>
<span class=c1># the `with` block.</span>
<span class=k>with</span> <span class=n>temp_dir</span><span class=p>()</span> <span class=k>as</span> <span class=n>td</span><span class=p>:</span>  <span class=c1># create temporary directory `td`</span>
    <span class=n>run_experiment</span><span class=p>(</span><span class=n>base_dir</span><span class=o>=</span><span class=n>td</span><span class=p>,</span>  <span class=c1># set the base directory for log files</span>
                   <span class=n>instances</span><span class=o>=</span><span class=n>problems</span><span class=p>,</span>  <span class=c1># define the problem instances</span>
                   <span class=n>setups</span><span class=o>=</span><span class=p>[</span><span class=n>make_rls</span><span class=p>,</span>  <span class=c1># provide RLS run creator</span>
                           <span class=n>make_random_walk</span><span class=p>],</span>  <span class=c1># provide random walk creator</span>
                   <span class=n>n_runs</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>  <span class=c1># we will execute 5 runs per setup</span>
    <span class=c1># Once we arrived here, the experiment with 2*2*5 = 20 runs has completed.</span>

    <span class=n>data</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>pr_from_logs</span><span class=p>(</span>  <span class=c1># we will load the data into this list</span>
        <span class=n>path</span><span class=o>=</span><span class=n>td</span><span class=p>,</span>  <span class=c1># the result directory</span>
        <span class=n>time_unit</span><span class=o>=</span><span class=s2>"FEs"</span><span class=p>,</span>  <span class=c1># time is in FEs (as opposed to "ms")</span>
        <span class=n>f_name</span><span class=o>=</span><span class=s2>"plainF"</span><span class=p>))</span>  <span class=c1># use raw, unscaled objective values</span>

    <span class=c1># The first plot will contain every single one of the 20 runs.</span>
    <span class=c1># The system will choose different styles for different algorithms</span>
    <span class=c1># and different problems.</span>
    <span class=c1># It will also automatically pick the labels of the axes and choose</span>
    <span class=c1># that the horizontal axis (FEs) be log-scaled.</span>
    <span class=n>fig</span> <span class=o>=</span> <span class=n>create_figure</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># create an empty, 4"-wide figure</span>
    <span class=n>plot_progress</span><span class=p>(</span><span class=n>progresses</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>  <span class=c1># plot all the data</span>
                  <span class=n>figure</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>  <span class=c1># into the figure</span>
    <span class=c1># Notice that save_figure returns a list of files that has been generated.</span>
    <span class=c1># You can specify multiple formats, e.g., ("svg", "pdf", "png") and get</span>
    <span class=c1># multiple files.</span>
    <span class=c1># Below, we only generate one svg image and remember the list (containing</span>
    <span class=c1># the single generated file) as `files`. We will add all other files we</span>
    <span class=c1># generate to this list and, in the end, display all of them in the web</span>
    <span class=c1># browser.</span>
    <span class=n>files</span> <span class=o>=</span> <span class=n>save_figure</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>  <span class=c1># store fig to a file</span>
                        <span class=n>file_name</span><span class=o>=</span><span class=s2>"progress_single_runs_f_over_log_fes"</span><span class=p>,</span>
                        <span class=n>dir_name</span><span class=o>=</span><span class=n>td</span><span class=p>,</span>  <span class=c1># store graphic in temporary directory</span>
                        <span class=n>formats</span><span class=o>=</span><span class=s2>"svg"</span><span class=p>)</span>  <span class=c1># file type = svg</span>
    <span class=k>del</span> <span class=n>fig</span>  <span class=c1># dispose figure</span>

    <span class=c1># Let us now only plot the runs on the OneMax problem.</span>
    <span class=c1># This will still use both algorithms.</span>
    <span class=c1># The system will again choose styles to make the curves distinguishable</span>
    <span class=c1># and will log-scale the horizontal axes.</span>
    <span class=n>fig</span> <span class=o>=</span> <span class=n>create_figure</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># create an empty, 4"-wide figure</span>
    <span class=n>plot_progress</span><span class=p>(</span><span class=n>progresses</span><span class=o>=</span><span class=p>[</span><span class=n>r</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>data</span>  <span class=c1># plot selection of data</span>
                              <span class=k>if</span> <span class=p>(</span><span class=s2>"onemax"</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>instance</span><span class=p>)],</span>  <span class=c1># only OneMax</span>
                  <span class=n>figure</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>  <span class=c1># plot into figure fig</span>
    <span class=c1># We save the figure as a file and add this file to the list `files`.</span>
    <span class=n>files</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>save_figure</span><span class=p>(</span>
        <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>  <span class=c1># plot into figure fig</span>
        <span class=n>file_name</span><span class=o>=</span><span class=s2>"progress_single_runs_f_over_log_fes_onemax"</span><span class=p>,</span>
        <span class=n>dir_name</span><span class=o>=</span><span class=n>td</span><span class=p>,</span>  <span class=c1># store file in temporary directory</span>
        <span class=n>formats</span><span class=o>=</span><span class=s2>"svg"</span><span class=p>))</span>  <span class=c1># again as svg</span>
    <span class=k>del</span> <span class=n>fig</span>  <span class=c1># dispose fig</span>

    <span class=c1># We now plot only the runs of the RLS, but for both problems.</span>
    <span class=c1># The system will again choose styles to make the curves distinguishable</span>
    <span class=c1># and will log-scale the horizontal axes.</span>
    <span class=n>fig</span> <span class=o>=</span> <span class=n>create_figure</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># create an empty, 4"-wide figure</span>
    <span class=n>plot_progress</span><span class=p>(</span><span class=n>progresses</span><span class=o>=</span><span class=p>[</span><span class=n>r</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>data</span> <span class=k>if</span> <span class=p>(</span><span class=s2>"rls"</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>algorithm</span><span class=p>)],</span>
                  <span class=n>figure</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
    <span class=c1># This time, we save three files: a svg, a pdf, and a png. Later all</span>
    <span class=c1># three will be opened in the web browser.</span>
    <span class=n>files</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>save_figure</span><span class=p>(</span>
        <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>
        <span class=n>file_name</span><span class=o>=</span><span class=s2>"progress_single_runs_f_over_log_fes_rls"</span><span class=p>,</span>
        <span class=n>dir_name</span><span class=o>=</span><span class=n>td</span><span class=p>,</span> <span class=n>formats</span><span class=o>=</span><span class=p>(</span><span class=s2>"svg"</span><span class=p>,</span> <span class=s2>"pdf"</span><span class=p>,</span> <span class=s2>"png"</span><span class=p>)))</span>
    <span class=k>del</span> <span class=n>fig</span>

    <span class=c1># Let us now convert the progress data to statistics runs.</span>
    <span class=c1># We apply StatRun.from_progress to a copy of the data and append all</span>
    <span class=c1># new StatRuns to the original data list.</span>
    <span class=c1># This function will automatically choose to compute statistics over</span>
    <span class=c1># algorithm*instance combinations unless we tell it otherwise.</span>
    <span class=c1># We tell it to compute the arithmetic means.</span>
    <span class=n>sr_from_progress</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=nb>list</span><span class=p>(</span><span class=n>data</span><span class=p>),</span>  <span class=c1># iterate over _copy_ of data</span>
                     <span class=n>statistics</span><span class=o>=</span><span class=s2>"mean"</span><span class=p>,</span>  <span class=c1># compute the mean f over FEs</span>
                     <span class=n>consumer</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>append</span><span class=p>)</span>  <span class=c1># and store to data list</span>
    <span class=n>fig</span> <span class=o>=</span> <span class=n>create_figure</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># create a 4"-wide, empty figure</span>
    <span class=c1># We now plot the single runs AND the mean result quality over time into</span>
    <span class=c1># the same diagram. Notice that the system will again automatically choose</span>
    <span class=c1># an appropriate style.</span>
    <span class=n>plot_progress</span><span class=p>(</span><span class=n>progresses</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>figure</span><span class=o>=</span><span class=n>fig</span><span class=p>)</span>
    <span class=n>files</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>save_figure</span><span class=p>(</span>
        <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>  <span class=c1># save the figure</span>
        <span class=n>file_name</span><span class=o>=</span><span class=s2>"progress_single_runs_and_mean_f_over_log_fes"</span><span class=p>,</span>
        <span class=n>dir_name</span><span class=o>=</span><span class=n>td</span><span class=p>,</span> <span class=n>formats</span><span class=o>=</span><span class=s2>"svg"</span><span class=p>))</span>
    <span class=k>del</span> <span class=n>fig</span>  <span class=c1># dispose figure</span>

    <span class=n>fig</span> <span class=o>=</span> <span class=n>create_figure</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># create a 4"-wide, empty figure</span>
    <span class=c1># We now create the same plot again, but this time we do not log-scale</span>
    <span class=c1># the horizontal (FEs) axis.</span>
    <span class=n>plot_progress</span><span class=p>(</span><span class=n>progresses</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>figure</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>
                  <span class=n>x_axis</span><span class=o>=</span><span class=n>AxisRanger</span><span class=o>.</span><span class=n>for_axis</span><span class=p>(</span><span class=s2>"FEs"</span><span class=p>,</span> <span class=n>log_scale</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
    <span class=n>files</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>save_figure</span><span class=p>(</span>
        <span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span> <span class=n>file_name</span><span class=o>=</span><span class=s2>"progress_single_runs_and_mean_f_over_fes"</span><span class=p>,</span>
        <span class=n>dir_name</span><span class=o>=</span><span class=n>td</span><span class=p>,</span> <span class=n>formats</span><span class=o>=</span><span class=p>(</span><span class=s2>"pdf"</span><span class=p>,</span> <span class=s2>"svg"</span><span class=p>)))</span>
    <span class=k>del</span> <span class=n>fig</span>  <span class=c1># dispose figure</span>

    <span class=n>fig</span> <span class=o>=</span> <span class=n>create_figure</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># create an empty, 4"-wide figure</span>
    <span class=c1># This time we only plot the arithmetic mean runs.</span>
    <span class=c1># We generate a pdf and a svg.</span>
    <span class=n>plot_progress</span><span class=p>(</span><span class=n>progresses</span><span class=o>=</span><span class=p>[</span><span class=n>d</span> <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>data</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=n>StatRun</span><span class=p>)],</span>
                  <span class=n>figure</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>
                  <span class=n>x_axis</span><span class=o>=</span><span class=n>AxisRanger</span><span class=o>.</span><span class=n>for_axis</span><span class=p>(</span><span class=s2>"FEs"</span><span class=p>,</span> <span class=n>log_scale</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
    <span class=n>files</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>save_figure</span><span class=p>(</span><span class=n>fig</span><span class=o>=</span><span class=n>fig</span><span class=p>,</span>
                             <span class=n>file_name</span><span class=o>=</span><span class=s2>"progress_mean_f_over_fes"</span><span class=p>,</span>
                             <span class=n>dir_name</span><span class=o>=</span><span class=n>td</span><span class=p>,</span> <span class=n>formats</span><span class=o>=</span><span class=p>(</span><span class=s2>"pdf"</span><span class=p>,</span> <span class=s2>"svg"</span><span class=p>)))</span>
    <span class=k>del</span> <span class=n>fig</span>  <span class=c1># dispose figure</span>

    <span class=c1># OK, we have now plotted a set of different progress plots.</span>
    <span class=c1># We will open them in the web browser if we are not in a make build.</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>is_build</span><span class=p>():</span>
        <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>  <span class=c1># for each file we generated</span>
            <span class=n>open_new_tab</span><span class=p>(</span><span class=sa>f</span><span class=s2>"file://</span><span class=si>{</span><span class=n>file</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>  <span class=c1># open a browser tab</span>
        <span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>  <span class=c1># sleep 10 seconds (enough time for the browser to load)</span>
<span class=c1># The temp directory is deleted as soon as we leave the `with` block.</span>
<span class=c1># Hence, all the figures generated above as well as the experimental results</span>
<span class=c1># now have disappeared.</span>
</pre></div>
