"""Test the WModel benchmark problem."""
from typing import Final

import numpy as np
from numpy.random import Generator, default_rng

from moptipy.examples.bitstrings.w_model import WModel
from moptipy.tests.objective import validate_objective
from moptipy.tests.on_bitstrings import random_bit_string


def test_wmodel() -> None:
    """Test the WModel objective function."""
    random: Final[Generator] = default_rng()

    for _ in range(3):
        nopt: int = int(random.integers(3, 64))
        m: int = int(random.integers(1, 12))
        nu: int = int(random.integers(2, nopt + 1))
        gamma: int = int(random.integers(0, (nopt * (nopt - 1)) // 2))
        f: WModel = WModel(nopt, m, nu, gamma)
        validate_objective(
            objective=f,
            solution_space=f.space(),
            make_solution_space_element_valid=random_bit_string,
            is_deterministic=True,
            lower_bound_threshold=0,
            upper_bound_threshold=nopt)


def test_wmodel_on_fixed_cases() -> None:
    """Test the WModel objective function on 300 random test cases."""
    cases: list[str] = [
        "3;1;2;0;TTT;2",
        "3;2;2;3;FFTTFT;3",
        "3;2;3;1;TFFFTF;0",
        "3;3;2;2;TTTFFFTFT;1",
        "3;3;3;0;FTFTFFFFT;1",
        "3;3;3;3;TFFFFTTTF;2",
        "3;4;2;1;FTTFFTFTFTFT;3",
        "3;4;3;0;FFFFTTFFTFFT;1",
        "4;1;2;1;FFTF;4",
        "4;1;2;3;TFFT;3",
        "4;1;3;5;TTFT;2",
        "4;2;2;1;TTFTFFFT;1",
        "4;2;2;6;TTFTFTFF;1",
        "4;2;3;2;FFTFFFFT;1",
        "4;2;4;0;TTTTFTTF;3",
        "4;3;2;1;TFFTTTFFFTTF;0",
        "4;3;3;6;TFTTFFFTFTFF;1",
        "4;4;2;2;FTFTFTTTTTTTFTTF;3",
        "4;4;2;4;FTFTTFTTTFFFFFTF;1",
        "4;4;2;6;TFTTFTFFTFTTFTFT;1",
        "4;4;3;1;FTFTFTTFFTTTTTTT;2",
        "4;4;3;4;TFFTTTTFTTFTTTTF;1",
        "5;1;2;6;FTFFF;5",
        "5;1;4;1;TFTFT;2",
        "5;2;2;10;TTTFFFFTTT;4",
        "5;2;3;10;TFTFFFTTTT;4",
        "5;2;4;8;TTTFFTTFTF;1",
        "5;2;4;10;TFFTTTTTFT;1",
        "5;2;5;6;FTFTTTFFFF;3",
        "5;3;2;2;TFFFTTTTFTTTTTT;2",
        "5;3;2;9;FFTFTTTFFFTFFTT;4",
        "5;3;3;4;FFFTFTFTTFTTTFT;2",
        "5;3;3;6;FFTTTFTFTFFTTTT;3",
        "5;3;3;9;TTFFFTFTTFFFTTT;4",
        "5;4;2;0;TTTFFTFFFFFTTTTFTTFF;3",
        "5;4;2;2;TFTTTFFFFTTTTTFFFFFF;4",
        "5;4;2;10;TFTTFFTTFTTFFFTFTTFT;1",
        "5;4;4;8;TFFTTTFTFTFFFTTTFTTT;5",
        "5;4;4;9;FTTFFFFTTTTTTTFTTFTT;2",
        "5;4;5;1;TTTFTFTTTFFTFTFFTFFF;3",
        "6;1;3;6;FTFTTF;1",
        "6;1;4;4;FTFFFF;3",
        "6;1;6;0;TTFTTT;1",
        "6;1;6;7;TTFFTF;2",
        "6;2;3;7;TTTFTFTFTFTT;2",
        "6;2;4;9;FFTTFTFTFFTT;6",
        "6;2;5;7;TTFFFTFTTTFF;1",
        "6;2;6;8;FFFTFTTTFTTF;1",
        "6;2;6;12;TFTTTFFTTTTT;2",
        "6;3;2;11;FTFFFTTFTFFFFTTTTF;4",
        "6;3;2;13;TFFTTTTTTFTFTTFFTF;2",
        "6;3;4;14;FTFTTFTFFTTTFFTFTF;1",
        "6;3;5;5;FFFTFTTFTTFFFTTTTT;5",
        "6;3;5;6;TTTTTTFTFFFFTTTTTF;2",
        "6;4;3;7;TTFFTFTFTFFFFFFFTTTTFTTF;4",
        "6;4;3;11;TFFFTFTTFTFTFFFTFFTTTFFF;5",
        "6;4;3;13;TFTFTFFFFFTFFFTTFTTFFTTT;3",
        "6;4;3;14;TTFTFFTTTTTFFFFFTFFTFTFF;2",
        "7;1;2;7;FFFTFFF;1",
        "7;1;5;15;FTTFTTT;5",
        "7;1;7;2;TFFTTTF;4",
        "7;2;2;19;FFFTFTTTTTFFFF;5",
        "7;2;3;14;FTFTFFFTTTTFTT;4",
        "7;2;4;7;FTTFTFTTTTTTTT;4",
        "7;2;4;12;TFTTFFTFFTFTFT;1",
        "7;2;7;12;TTFTFTFFTTTTFF;2",
        "7;3;4;3;FTFFFTFTFTFFTFTFFTFTT;2",
        "7;3;4;4;TTTTFTTTFFFTTFFFTFFTF;4",
        "7;3;4;17;FTFTTTTFTFTTFFTFFFFFF;5",
        "7;3;5;2;TFTFTFTFTFFFTTTFFTFTF;7",
        "7;3;5;6;FFTFTFFFTTTTFFFTFFTTT;5",
        "7;3;6;0;TTTFTFTTTTFTFFFTFTTTF;5",
        "7;3;7;12;TFTTTFFFTFTFTFFFTTTFF;1",
        "7;3;7;18;TTFTTFTTFTFFTFTTFTFTF;3",
        "7;4;2;11;FFFFTTFFFTFTFFTFFTFFFFTFFFTF;6",
        "7;4;4;2;TTTTFFTFFFTTTFFTTTTFTFFTTFFF;4",
        "7;4;4;6;FFTTTFFTTFTFTTTTFFFTFFTTTTFF;5",
        "7;4;5;9;FFTFTFTFTFFFFTTTFFFFTFFFTFFF;5",
        "7;4;6;11;FFFFTTTTTFTTFFTTFFTTFTTFTTTF;6",
        "7;4;7;3;TFFTTTFTTFTTTTTTTTFFTTFTTTTT;5",
        "8;1;2;6;FFFTTFFT;4",
        "8;2;3;9;TFFFTTFFTFFTTFTF;3",
        "8;2;8;18;TTTTFFFFTFFFTFTT;2",
        "8;3;2;13;TTTFFTFTFFFTFTFTFTFFFTTF;7",
        "8;3;3;24;FFFTTTTFFFFFFFFTFFTTFTFT;3",
        "8;3;6;8;FTTTFFTTFTTTFFFFTFTFFTTT;2",
        "8;3;7;21;FTTTTTTTTFFFTFTFTFFFFFTF;7",
        "8;4;3;23;FFTFFTFTFTTFTFFTTFTTTFFFTFFTFTTT;4",
        "8;4;5;12;TTTFTTTTTFTTTFFTTTTTTTTFTTTTFFTF;4",
        "9;1;7;32;TTTFTTFTT;5",
        "9;1;9;8;TFFTFTTFT;6",
        "9;2;9;11;FFFFTFFFFTTTFFTTFF;3",
        "9;3;2;18;FTFTTFTFTTTTTFFFTFFFFFFFFFT;8",
        "9;3;4;12;TFTTFTFFTTTFTTFTTFTFFTTFTTF;9",
        "9;3;5;6;FFTTTFFTTFTFTFFTTFFTFFTTTTT;5",
        "9;3;8;23;TTFTFTTTTTFFTTFTFTFFTTFFTTT;7",
        "9;4;3;19;TFTFFTTTTFTTTTTTTFFFTFTTFTTFFTFFFTFT;7",
        "9;4;3;20;FTFTFFTFTTTFFTTFFFFFTTFFTTTFFTFTFFFT;7",
        "9;4;3;36;FFTFTTFFFTFTFTFTFTTTFTTTTTFTTTFFFTFT;6",
        "9;4;4;25;TTFTTFFTTFFTFFTTFTFTFTFTFTFFFTFTTTTT;6",
        "9;4;5;28;TTFTFFTTTFFFTTTFTTFFFTTFTTFFFFFTTFFF;7",
        "9;4;6;24;TFTTTTFFFTFTTTFFFTFTFTTFTFFFFFTFTTFF;5",
        "9;4;9;32;TTTTFTTTTFTFTFFTFFFTFTFFTTTFTTFFTFFF;4",
        "10;1;5;26;TFFTFFTTFT;2",
        "10;1;6;29;FFFFFFFTTF;8",
        "10;1;9;29;FFTTFTTTFT;2",
        "10;2;4;43;TFFTFTTTFTTTFFFTFTTT;6",
        "10;2;6;13;TFFFFFTFTFTTTFFFFTFT;6",
        "10;2;7;41;FFFFFFTFTFFFFFTTFTFT;7",
        "10;2;9;4;TFTFTTFFTTTFTFTTFFFF;7",
        "10;2;9;35;TTTTTTTTTFFFTFFFFTFF;3",
        "10;2;10;8;TFTTTFTFTFFFTFFTFTFT;6",
        "10;3;2;10;TFTTTTTTTFTFTFFFFFTFTTFFTTFFTF;7",
        "10;3;3;5;FFTTTFFFFTTFFFFTFFTTTFFTTTTTFT;2",
        "10;3;6;3;TTTTFTTTFTFTTFTTTFFFFFFFTFTTTT;6",
        "10;3;7;42;TTFTTFFTTTFTFTFFTTTTTTFFFFFFFT;4",
        "10;3;8;26;FTFFFTTTTFFTFTTTTTFTTFFFFFTTFF;9",
        "10;3;9;6;TFFTTFFTTTTTFTFFTTTFFFFTFTTTTF;5",
        "10;4;2;14;TFFFFTTTFTTTTFFTFTTFTTFTFTFTFFFTTFTTTFFT;5",
        "11;1;3;34;FFTTFTTFTTT;3",
        "11;1;4;0;FTTFFTFTTTF;8",
        "11;1;4;15;TFFTTFFTFFT;9",
        "11;1;7;17;TTFTTFFTFTT;6",
        "11;1;8;5;TTFFFFTTFTF;7",
        "11;2;3;19;FFTFTTTFFFFFTTFTTFFFFF;3",
        "11;2;4;11;TTTFFFTTFFFTTTTTTTTTFF;2",
        "11;2;5;24;FTTFFFTFTTTTTTTTTFFFTT;5",
        "11;2;6;44;TFFTFTTTTTFFFTFTTTFFFF;7",
        "11;2;7;2;FTFFFFTTTFTTTTTFTFFTTT;5",
        "11;2;11;22;FFTFTFTFTTTTTTFFTTFFTT;10",
        "11;2;11;27;TTTTTTTFFFFTTFTTTTFTFT;3",
        "11;3;3;21;TTFTFTFFTFFFFTFTTFFTFFFFFTTFFFFFT;4",
        "11;3;8;8;FFFTTFTTFTTFFTFFTFFFFTFFTFTTFFTFF;6",
        "11;3;9;47;TTTTFFTFTFTFFTTTFFTTTFFTTTFFFTFTT;10",
        "11;3;10;8;TTFTFTFFFTTFTTTTFFTFTFTTTTFFTFFTT;7",
        "11;3;10;35;TTFFTTFFFFFTTTFTFTFTTTFTTTTFTFFFF;9",
        "11;3;11;8;FFFFTTFFFTFTTFTFTTTFFFFTFTTTTFFTF;8",
        "11;4;2;7;TTTFTTFFFTFTFTTFFFTFTFFFFTFTTTTFTFFFTTFTTFTT;6",
        "11;4;3;1;FTTFFFTFTFTFTFTTTTTTTFTTTTFFFTFFFTFTFTTFFTTF;1",
        "11;4;9;37;TTFTFTFTTTTTTTTFFFFTTTFFTFTTFFFFFTFFFTFFTFTT;7",
        "11;4;11;53;FTFTFFFTFTTFTFFFTFTFFFFFFFTFFTFFFFTFFFTFFFTF;3",
        "12;1;6;46;FFTFTTTFTTTF;9",
        "12;1;10;10;TFFTTTFFFTTT;6",
        "12;1;12;52;FFTTFTFTFTFF;11",
        "12;2;7;65;FFTTTTFTTTTFTFFFTFFFFFTT;7",
        "12;2;9;66;TFFTFFTTFTTFTFFFTTFFFFTF;8",
        "12;2;10;39;FFFTTTTFFFTTFFTFFTFFTTFT;6",
        "12;3;2;22;TFTFFTTFFTTFTTTTTFTTTTFFTFFFTTFFTFTT;3",
        "12;3;2;61;TTFFFFFFFFTFTTFTTFTFFTTTTTFFTFTFTTTF;5",
        "12;3;6;45;TTFFFTTTTTFFFFFTTFFTTFFFFFTFFFTTFTFF;10",
        "12;3;10;31;TFTTTTTFFFTTTFTFFTFFFTFFTTFFTFFFFTFF;3",
        "12;3;10;45;TTFFFFTTFTFTFTFFFTTTFTTFTFFFFTTFFTFT;10",
        "12;3;10;65;TTTFFTTFTFTFFTFTTTFTTTFTTFTTFFTTTFFT;8",
        "12;3;12;61;FTFFFTTTFTTTTFFTTFFFTFFFFFFFTFFTTFTF;6",
        "12;4;2;3;FTFFFTTTTFTTTFTFTTFTFFFTFFFFTFTTTFFTFFTTFFFTTFTF;4",
        "12;4;4;10;TFFFFFFTFFFTTFFTTFTTFFFFFFFTFFTTTTFFFFTTTTFTTFFF;7",
        "12;4;5;29;TTFTFFTFFFFFFTFTFTTFTFTFTTFFFTFTFFFTFFFTTTFTTTFF;4",
        "12;4;7;55;FTTFFTTFFFFFFTTFFTTTFTTFTFTTTTTFTFTFFTTTFTTTFFTF;8",
        "12;4;12;43;FFTTFFFTTTFFTTTFFTFFFFFFTTFTTTFFTFTFFTTTTFTFFFTF;10",
        "13;1;3;27;FFTTTFTTFTFTF;8",
        "13;1;4;70;FFTTTTFTFTTTT;9",
        "13;1;5;55;TTTTTFFTTFTTF;8",
        "13;1;5;78;TTFTFFFFTFFFT;7",
        "13;1;9;13;FTFFFTTFTFFFF;5",
        "13;1;9;66;TTFFTFTTTTTTT;11",
        "13;1;9;71;FTFFTTTFTTTTF;5",
        "13;1;9;73;FFTTFFTFFTFFT;6",
        "13;1;13;19;FTTFTTFTFFTFF;6",
        "13;2;2;1;FFTFFFFTFFFTFTTFTFTTFTFFFF;4",
        "13;2;4;22;TFTFTFTFTFFTTTFTTFTTTTFTTF;10",
        "13;2;6;67;TFFFFTFTTFFFTFTFFFFFTFTTFT;8",
        "13;2;6;73;FTFTTFTFTTTFTFFTTFTTTFTFTF;4",
        "13;2;7;55;FFTTTTTTTFTTFTTFTTTTTFTFFF;10",
        "13;2;9;72;FFTTFTTTTTTTFFTTFFFFTTTFFT;4",
        "13;2;11;35;FFTTFFFFFFFTFFTFFTFFFFFFFT;7",
        "13;3;2;48;TTFFFFFTTFTTTFTFFTFTTTFTFFFFFFFTFFFFTFF;9",
        "13;3;5;17;TFTFFTFFFTTTFFFTFTFTFFTFFFFFFTFTFTFFTFT;8",
        "13;3;6;6;TFTTFTFFFTTFTTFTTTFFTTFFTTFFTFTTTFFTFTF;2",
        "13;3;8;50;TFTFTTFTTTTTFFTFFFFTTFFTFTTTFTFTTFTFTFF;10",
        "13;3;10;26;TTTTTTFTTFTTFFTFTFTTTFFFFFTFFFFFTTTFFFF;4",
        "13;3;11;46;FTFTTTTTTFTFTFFTFTFFTFFFTFTFFTFFFFFFFTT;10",
        "13;3;13;34;FFTTTFTFTFFTFFTTFTTFTTTFFFFTTTFFFTFFTFF;5",
        "13;4;8;41;FTTTFFTTFTTFTTFFTTFTFFFTTFTFTTFFTFTFTFFFFFTTFFTFTTTF;9",
        "13;4;10;21;FFTFTFTFTFFFFTTTTFTFTFTTTTTTFFTTFTTTTTTFFFFFFFTFTTFF;10",
        "13;4;11;42;FTTFTTTTTFFTTFTTFFTTTFFTFTFTTTFFTTTTFTFFFFFTFFTFTFFF;10",
        "14;1;6;76;FFFFFFFFFTFTFF;7",
        "14;1;11;85;TFFFFTFTFTTFTF;9",
        "14;2;4;21;TTTTTFFTFTFFTTFFTTTTFTTFFFFT;7",
        "14;2;6;7;TFTFTTFFFTFFTFFTFTFFTFTTTTFT;8",
        "14;2;7;83;TTTFFTTFTTTTTTFFTFTFTTFFTTFT;6",
        "14;2;10;46;FTFFFFFTTTTFTFTFFTTFFFTFFFFF;11",
        "14;3;2;19;FFTTFFFFFFTTTTTFTTFFFTFFFFTFFTTTTTTTTFTFTT;5",
        "14;3;8;73;TTTFTTFTTFFTTTFFFTTFFFFTFTFTTFFFTFFFTFTTFF;10",
        "14;3;11;65;TTTFTTTFTTFFTFTTFFTFTFFFFTTTTFFTTFFFTTTTTT;2",
        "14;4;4;7;FTTTTFFTTTTTFTTFFFTFTTFTFFTTFFFTTTFFFTTFTTFTFFFFFTTFTFFF;9",
        "14;4;6;1;TTFTTTFFFFFFFFTFTFFFFTTFFTTFFTFFFTFFFFTTFFTTTFFFFFFTTTTF;4",
        "15;1;2;78;FFFFFTFFTTTTFTF;13",
        "15;1;6;18;TFFTFFFFTFFFTTF;9",
        "15;1;7;20;TFTFTTFTFTFTTTT;3",
        "15;1;9;90;FTTFTTFTTFTFTTF;9",
        "15;2;6;55;TTFFFFFTFTTFTFFFTFFTFTFFTTTTTT;4",
        "15;3;2;44;FTFTTFFTFTTFFFFFTTTFFTTTFTFTTFFFFTTFFFFTTFTTF;15",
        "15;3;11;47;TFTFFTTFTTTFTFTTTTFTFTFFFTFTTFTFTFFFFFTFTTTTF;4",
        "15;3;13;40;TTTTTTFFTFFFTTFFFTTTFTTTFTTTTTTTTFTFTFTTFFFFF;7",
        "15;3;14;91;FFFFFFTTFTFTFFTTFTFTFFTTFTTFFFTTTTTFFTTTTFTTT;10",
        "16;1;4;76;FFFTTFTFFFTTFFTT;3",
        "16;1;6;93;TFTFTFFFFTFTFTFT;4",
        "16;2;6;7;TFTFFFFFTFTFTFTTTTTTTFTFFTFTFTTT;12",
        "16;2;10;111;FTFFTFFFTTTFFFTTFTFTFTTTFFFTTFFF;7",
        "16;2;12;99;TTFTFTFFTFFTFFFTFFFFTTFTFTTFTFFT;7",
        "16;2;13;62;TTFTFFFFTTFFFTTTFTFTTFTFFFFTFFTT;5",
        "16;3;6;21;TTFTTFFTTFTFTFFFFFTTTFFTTTFFFFFFFTTTTTFFFFFFFTTF;8",
        "16;3;9;2;TTFTTTFFFFFTTTFFFTFTTTFFFFTFTTFTFFTFFFFTFFTFFTTF;8",
        "17;1;3;133;TTTFFTTTTTTFFFTTT;10",
        "17;1;4;25;FFTFFFTTTFTTTTTTF;10",
        "17;1;9;16;FTFTTFTTFFFFFTTTT;9",
        "17;1;15;38;TFTTFFTFTFTFFFFFT;4",
        "17;2;4;21;TFTTTFFTTTTTFTFFFFTTTTFTFTTTTTTFTF;9",
        "17;2;6;13;FTFTTFFFFTTTTTFTTFTTFTFTTFTFFTTTTF;11",
        "17;2;10;41;TFTFTTFFTFFFTFFTTFFFTTTTFFFTTTTTTT;10",
        "17;2;12;134;TTFTTFTTTTTFTFFFTTFTTFFFTFTFFFTFTF;10",
        "17;3;9;6;TTTTFFTFFFTFTTFTTFTTFFTFFFFTFTFTTFTTFFTTFTFTTTTTTFT;7",
        "18;1;4;65;TTTFFFTTTFTFTFTTTF;4",
        "18;1;8;87;FTFTTFTFTFTFTFTFFF;3",
        "18;1;12;53;FTTTFFFFFTTFFFTTTT;5",
        "18;1;14;47;FFTTFFFTTFTFFFTFFF;7",
        "18;1;17;114;FTTFFTFTTFTFTTTFTT;15",
        "18;2;2;5;TFFFFFFFTFFTTTTFFFTFFFTTTTFTFFTTTTTT;7",
        "18;2;6;62;FFTTTTFTTFTFTTFTFFFFTFFTFFTTFFTTFFTT;3",
        "18;2;6;83;TFFTTTFTTFFTTFFTTFFFFTTFTFTFFTFTFTFT;13",
        "18;2;8;22;TTTFFTTTTTFFTTFFFFFTFFFFFFFFFFFTFTFT;10",
        "18;2;10;137;TTTFTTTFFTFFTTFFFFTTTTTFTFFFFTTFTFFF;12",
        "18;2;10;30;FTFFFTTFFTFFFFTFTTFTFTTFTTFFFTFFTTFT;8",
        "18;2;11;121;FTFTTFFTTTTFTTTTFTFFFTFTTTTTFTFFFFFF;14",
        "19;1;3;90;TFFFTTTFFTTTFTTFTFF;5",
        "19;1;10;151;TTFTTTTTTFTTTFTFTFF;8",
        "19;1;15;101;FFTFFFTTFTTTFTTFTFT;16",
        "19;1;15;37;FTTFFTTTFTFFTTTFFTF;6",
        "19;1;19;25;TFFFFTTFTFTFTTTFFTT;5",
        "19;2;14;62;TTTFFFFFTFFTFTTFTTTFFTTTTTTFFTTTFTTTFF;7",
        "19;2;17;37;TFTTFFFTFFFFFTFFFTFTTFTFFTTTFTTFTTFTTT;7",
        "19;2;18;36;FTTFFTFTFFFFFFTFFTTFTTFTFFFTFFTFTTFTTF;4",
        "20;1;2;149;TTTFTTTFFTTTFFTTFFFF;12",
        "20;2;2;135;FFTFTTFTTFTFTTTFTTFFTTFFTFTFTTTTFFTTTFTT;14",
        "20;2;6;51;TTTFTFFFFTTFTTFTFFFFFFTFTTTFTFTFTFTTFTTF;9",
        "21;1;19;146;TTFFFTTFTFFTTFTFTFTFT;4",
        "21;1;19;185;FFTTFFTTTTTFTFFFFFTTF;8",
        "21;1;21;68;FFFFFFTFFTTTTFTFTFFTT;12",
        "21;2;13;123;TFFTFFFFTFTTTFFTTFFFTTFFFFTTFTFFTFTTTTFFFT;3",
        "21;2;14;36;FFFFTFTTFTTFFFTFFFFFFTTTFTTFTTFFFFFTFFTFFF;8",
        "21;2;14;95;TTFFFFTFFTFFFFTFTFTFFTFFTTTFFFFTFFTFTFFFTF;5",
        "21;2;21;203;TTFTFTTTTFFTFFTTFFFFFFFFFTFTFTFFTTFTFTTFTT;11",
        "22;1;8;143;FTFTFFFTTFFTFTTTFTTFTT;3",
        "22;1;19;143;FFFTFTTFFTFTFFTTFFFFFF;18",
        "22;1;22;183;TTFTFFTFTFTTFTFTTFFTFT;10",
        "22;2;8;149;TTFFFTTFTTFTFTFTFFFTFTFFTFTFFTFFTTTFFFTTTTFF;15",
        "22;2;14;167;FTTTFFFFTTFFTTTTFFFTTTFTTFFTTTTTTTTTTFFFTTFT;13",
        "22;2;19;24;FTFFTFFTTTTFTFFFFTTFTFFFTTFFTTTFTFFTTTFFFTTF;15",
        "22;2;22;209;FFTFTTTTTTTFTTTTTTFFFFTFFTFTFFFFTTFFTFFFTFFF;15",
        "23;1;2;233;TFTFFTTFFFTTTTFTTTFFTTF;11",
        "23;1;11;62;TTTTTFFFFTFFTFFFTTFTTTT;10",
        "23;1;15;120;TTFFTFFTFTTTTTFTFFTTTTF;5",
        "23;1;17;246;FTTTFTFTFTFFTFTTFTTFTTF;16",
        "23;2;13;214;TFFTTTTTTFFFTFFFTFTTFFFFTFFTFTTTTFTFTFFFTFFTTT;8",
        "23;2;16;173;TFTTFFFTTTFTFFTFFFFFTTTTFFTFTFFTTFTTFFTFFTTTFT;4",
        "23;2;22;27;FTTTTFTFTFTFFTFTTFFTFTTFFFTTFFTFTTTTFFTFFTFFTF;14",
        "24;1;10;77;TTFTTFTTTTFFTTTTFTFTTTFF;14",
        "24;1;16;143;FFFFFFTTTTTTTFTTFFFTFFFT;17",
        "24;1;18;152;FTFFFFTFTTTFTFTTTTFFFFFF;5",
        "24;2;3;16;TTTFFTTTTTFFFFFTTFFFTFTFTFFTFFFTTTFTFFFTFFTFTFTF;12",
        "24;2;16;209;FFFFFTFFFFTFFFFTFFFTFFFFTTFTFFTFFTTTTFFFTFFTFFTT;18",
        "25;1;3;155;FTTFFFTTTTFFTTTFFTFFTTTTT;19",
        "25;1;11;248;TTTTTTFTFFFTFTFTTFFTFFTFF;19",
        "25;1;16;164;TFFFFFFFTTTTTTTTTTTTFTFFT;19",
        "25;2;5;73;FFFFFFTFTFFFFFFFFTFTTFTTFFFTTFFFTFTTTFFFFFTTFTTTTF;10",
        "25;2;12;18;TTFTTFTFTTFTTFTTTFTTTFFFTTTTTTTFFTFFFTFFTFFTFTTTTF;13",
        "25;2;12;283;TTTFTTFTFTFTFTTTFTFTFTFTTTTTTTTTTFFTFTFFFTFTTFTFTT;11",
        "25;2;18;172;TTTTTTTFFFFTFTTTFFFTFTTFTTFFFTTFFFTFTTFFTFTTFTFFTT;16",
        "26;1;5;121;FTTTFTFTFTTFTFTFFTFFTFTFTF;8",
        "26;1;14;285;TTTTTTFTTTFFTFFTFTFFTTTFTF;13",
        "26;1;15;251;FFTTFFTFFFTFTTFFFTTTFFFFTF;19",
        "26;1;25;4;TTFFFTFFFFTFFFFTFFTTFFTTTT;13",
        "26;2;9;168;TTFTTTTFFTTTFTTFFFFFTTFTFFTTTTTTTFFFFTTTTTTTFFFFTTFF;7",
        "26;2;13;47;FTFTFTFTFFTFFFFTFTTFTFTTTTTFTFFFFFTTFFFTTTFTFFTFTFFT;9",
        "26;2;16;184;FTTFTTFTTFFFFTTFTFTTFFTTFFFFTFFFTTTFFFTFTTTTFTTFFFFT;8",
        "26;2;23;185;FTFFTFFTFTFTTTFTFTFFFTFTFTTFTFTFTFFFTTFFTTFTTFFFFTTF;17",
        "27;1;3;332;TFTFFTFTFFFFFTFTFFFTTFFFFFT;16",
        "27;1;5;219;FFTFTFFTFTTTFFTTTFTFTTTTFFF;17",
        "27;1;6;262;TFFTFTTFFFTFFFTTTFTTTFTFFFF;22",
        "28;1;5;21;TFTFTTFTFTFFTFFFTFFFFTTFFTFT;18",
        "28;1;14;108;TTFTTTTTTTFTFFTTTFFFTFTTFTTT;14",
        "29;1;2;97;FTTTTFFTFTFFTFTFFFTFTFFTTFTFF;15",
        "29;1;14;134;TFTTFFFFFFTFFTFTTTFTTTFTFTTTT;15",
        "30;1;4;111;FFTFFTTTFFTFTTTFFFTTFFFTFFTTTT;12",
        "30;1;22;206;TFTFTTTTTFFTTFTTFFTTFTTFFFFTFF;23",
        "30;1;26;232;FTFFFFTFFFFFTFFTTTFFFFTFFTFTFT;22",
        "30;1;26;405;FTTTTFFFFTTTTTTTTFFTTFFTTFFFFF;17",
        "31;1;8;42;TTFFFTTFFTTFFFTFFFFTTFTFTTTFTFF;16",
        "31;1;23;161;TTFTTTFFTTTFTFTTTTFTFFFTTFFTTFT;12",
        "31;1;23;26;TFFFFFFFTFFFTTFFTTFTTTFFTFTTTTF;18"]

    for case in cases:
        vals = case.split(";")
        nopt = int(vals[0])
        m = int(vals[1])
        nu = int(vals[2])
        gamma = int(vals[3])
        x = np.array([xi == "T" for xi in vals[4]], bool)
        res = int(vals[5])
        model = WModel(nopt, m, nu, gamma)
        assert res == model.evaluate(x)
